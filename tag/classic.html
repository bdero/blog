<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>bran's blog - classic</title>
        <link rel="stylesheet" href="http://blog.bdero.me/theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://blog.bdero.me/">bran's blog </a></h1>
                <nav><ul>
                    <li><a href="http://blog.bdero.me/category/algorithms.html">Algorithms</a></li>
                    <li><a href="http://blog.bdero.me/category/experiments.html">Experiments</a></li>
                    <li><a href="http://blog.bdero.me/category/games.html">Games</a></li>
                    <li><a href="http://blog.bdero.me/category/scripts.html">Scripts</a></li>
                    <li><a href="http://blog.bdero.me/category/simulations.html">Simulations</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="http://blog.bdero.me/julia-set-viewer.html">Julia set viewer</a></h1>
<footer class="post-info">
        <abbr class="published" title="2013-09-28T23:16:00-04:00">
                Published: Sat 28 September 2013
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://blog.bdero.me/author/brandon-derosier.html">Brandon DeRosier</a>
        </address>
<p>In <a href="http://blog.bdero.me/category/algorithms.html">Algorithms</a>.</p>
<p>tags: <a href="http://blog.bdero.me/tag/2d.html">2d</a> <a href="http://blog.bdero.me/tag/algorithm.html">algorithm</a> <a href="http://blog.bdero.me/tag/browser.html">browser</a> <a href="http://blog.bdero.me/tag/canvas.html">canvas</a> <a href="http://blog.bdero.me/tag/classic.html">classic</a> <a href="http://blog.bdero.me/tag/fractal.html">fractal</a> <a href="http://blog.bdero.me/tag/html5.html">html5</a> <a href="http://blog.bdero.me/tag/interactive.html">interactive</a> <a href="http://blog.bdero.me/tag/iteration.html">iteration</a> <a href="http://blog.bdero.me/tag/ivankjs.html">ivank.js</a> <a href="http://blog.bdero.me/tag/javascript.html">javascript</a> <a href="http://blog.bdero.me/tag/julia-set.html">julia set</a> <a href="http://blog.bdero.me/tag/mobile.html">mobile</a> <a href="http://blog.bdero.me/tag/vector-graphics.html">vector graphics</a> <a href="http://blog.bdero.me/tag/visualization.html">visualization</a> <a href="http://blog.bdero.me/tag/webgl.html">webgl</a> </p>
</footer><!-- /.post-info --><p>A little bit of fun with fractals! <!--more--></p>
<iframe src="http://bdero.me/ivank-tests/julia/" width="100%" height="465" frameborder="no"></iframe>

<h5><strong>If you don't see anything in the frame above, then either <a title="Check if your browser supports WebGL" href="http://get.webgl.org/" target="_blank">your browser doesn't support WebGL</a>, or your graphics driver is not sufficient for initializing a WebGL context.</strong></h5>

<p>The source code is available on <a title="Julia Set viewer source code" href="https://github.com/bdero/ivank-tests/blob/gh-pages/julia/julia.js" target="_blank">GitHub</a>.</p>
<p>There's nothing special about the way each pixel's color is determined. It's colored based on the number of iterations it takes a point to escape the given distance bound (in this case, <em>sqrt(10)</em>) in the Julia set function, just like <a title="How Julia set images are generated" href="http://www.youtube.com/watch?v=2AZYZ-L8m9Q#t=358" target="_blank">any other typical fractal viewer</a>.</p>
<p>I decided to have it precompute the color pallet like this:</p>
<div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">generateColors</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">colors</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Uint32Array</span><span class="p">(</span><span class="nx">MAX_ITERATIONS</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">escapeTime</span><span class="p">,</span> <span class="nx">red</span><span class="p">,</span> <span class="nx">green</span><span class="p">,</span> <span class="nx">blue</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">colors</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">escapeTime</span> <span class="o">=</span> <span class="nx">i</span><span class="o">/</span><span class="nx">MAX_ITERATIONS</span><span class="p">;</span>

        <span class="nx">red</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">escapeTime</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="mh">0xff</span><span class="p">;</span>
        <span class="nx">green</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">escapeTime</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">)</span><span class="o">*</span><span class="mh">0xff</span><span class="p">;</span>
        <span class="nx">blue</span> <span class="o">=</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">escapeTime</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="mh">0xff</span><span class="p">;</span>

        <span class="nx">colors</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mh">0xff000000</span> <span class="o">|</span> <span class="nx">red</span> <span class="o">|</span> <span class="nx">green</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="nx">blue</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>...and here's what the color functions look like on a graph, where blue starts off strong and dies off, green peaks in the middle, and red ends up strong:</p>
<iframe src="http://graph.tk/" id="julia-set-viewer_colorgraph" width="100%" height="200" frameborder="no"> </iframe>

<script>
var graph=document.getElementById("julia-set-viewer_colorgraph");
graph.onload=function() { function g(m){ graph.contentWindow.postMessage(m,"http://graph.tk") };
g("add:(cos(x*pi)+1)/2"); // Blue
g("add:(-cos(x*pi)+1)/2"); // Red
g("add:sin(x*pi)"); // Green
g("scale:9,3");
g("center:0.5,0.5");
}</script>

<p>The viewer is made up of a few small components:
<ul>
    <li>A <strong>viewport</strong>, which finds the rectangle on the complex plane to render based on given <em>translation coordinates</em>, a <em>zoom multiplier</em>, and the current <em>window resolution</em>.</li>
    <li>A <strong>bitmap</strong>, which holds the most up-to-date <em>image buffer</em> to display via WebGL. Sections of it are continuously overwritten by the <strong>renderer</strong>.</li>
    <li>A <strong>renderer</strong>, which calls the Julia set function continuously, limiting each execution time a maximum of <em>20ms</em> and keeping track of where it left off in the <strong>bitmap</strong> between each call. It also keeps track of the <em>offset</em> (a complex number to add to a point each time it's squared in the Julia set function).</li>
    <li>A <strong>controller</strong>, which sets up the head-up display <em>buttons</em>, <em>text</em>, and user input <em>listeners</em> to modify the <em>zoom</em> and <em>center</em> of the <strong>viewport</strong> and randomly select new <em>offsets</em> for the Julia set function.</li>
</ul></p>
<p>Everytime you hit <strong>+</strong> to zoom in, the <em>zoom</em> of the <strong>viewport</strong> is multiplied by <em>1.5</em>. The <strong>viewport</strong> generates a rectangle every frame by essentially dividing a given starting rectangle's width and height by the <em>zoom</em>.</p>
<p>Because of this setup, if you zoom in far enough, you'll crash into a pixelated mess:
<img class="aligncenter" alt="julia_zoom" src="http://blog.bdero.me/images/julia_zoom.gif" /></p>
<p>This is due to the floating point numbers having limited precision - in the case of JavaScript, floating point numbers are 64-bit. You may also notice that the <strong>viewport</strong>'s <em>center</em> snaps while panning when you're zoomed in that far.</p>
<p>The graphics are provided by WebGL via the wonderful <a href="http://lib.ivank.net/" title="IvanK Lib" target="_blank">IvanK.js</a>. The Julia set itself is, however, ironically software rendered - mainly because IvanK.js isn't intended for use alongside low level access to WebGL.. and I wanted to see how fast I could get it to work in pure JavaScript. c:</p>
<p>No fragment shaders were <del>butchered</del> written in the making of this demo.</p>                </article>
            </aside><!-- /#featured -->
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">

            <li><article class="hentry">
                <header>
                    <h1><a href="http://blog.bdero.me/tower-of-hanoi.html" rel="bookmark"
                           title="Permalink to Tower of Hanoi">Tower of Hanoi</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2013-09-22T05:53:00-04:00">
                Published: Sun 22 September 2013
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://blog.bdero.me/author/brandon-derosier.html">Brandon DeRosier</a>
        </address>
<p>In <a href="http://blog.bdero.me/category/algorithms.html">Algorithms</a>.</p>
<p>tags: <a href="http://blog.bdero.me/tag/2d.html">2d</a> <a href="http://blog.bdero.me/tag/algorithm.html">algorithm</a> <a href="http://blog.bdero.me/tag/browser.html">browser</a> <a href="http://blog.bdero.me/tag/canvas.html">canvas</a> <a href="http://blog.bdero.me/tag/classic.html">classic</a> <a href="http://blog.bdero.me/tag/html5.html">html5</a> <a href="http://blog.bdero.me/tag/ivankjs.html">ivank.js</a> <a href="http://blog.bdero.me/tag/javascript.html">javascript</a> <a href="http://blog.bdero.me/tag/minimal.html">minimal</a> <a href="http://blog.bdero.me/tag/puzzle.html">puzzle</a> <a href="http://blog.bdero.me/tag/recursion.html">recursion</a> <a href="http://blog.bdero.me/tag/tower-of-hanoi.html">tower of hanoi</a> <a href="http://blog.bdero.me/tag/tweener.html">tweener</a> <a href="http://blog.bdero.me/tag/vector-graphics.html">vector graphics</a> <a href="http://blog.bdero.me/tag/visualization.html">visualization</a> <a href="http://blog.bdero.me/tag/webgl.html">webgl</a> </p>
</footer><!-- /.post-info -->                <p>I figured I'd start with something classic.</p>
                <a class="readmore" href="http://blog.bdero.me/tower-of-hanoi.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>
                </ol><!-- /#posts-list -->
                </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>